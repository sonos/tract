name: Run the tract ci minion on self hosted runners

on:
  schedule:
    - cron:  '*/5 * * * *'
  workflow_dispatch:

jobs:
  minion:
    strategy:
      matrix:
        platform:
          - macOS
          - cuda-lovelace

    runs-on: ${{ matrix.os }}

    steps:
    - name: Run minion if found
      run: |
        if [ -d $HOME/tract-minion ]
        then
          echo "Running minion"
          cd $HOME/tract-minion
          ./tract-ci-minion --once
        else
          echo "Not running minion"
        fi
